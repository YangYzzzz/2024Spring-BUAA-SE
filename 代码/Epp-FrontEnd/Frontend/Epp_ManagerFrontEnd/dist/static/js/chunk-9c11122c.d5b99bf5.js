(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9c11122c"],{"220d":function(e,t,n){"use strict";n("eae1")},"88eb":function(e,t){e.exports={messages:{CN:{add:"添加",delete:"删除",save:"保存",cancel:"取消",edit:"编辑",deleteConfirm:"是否要删除此行？",newMember:"新增成员",table:{name:"成员姓名",number:"工号",department:"所属部门",operation:"操作"}},HK:{add:"添加",delete:"刪除",save:"保存",cancel:"取消",edit:"編輯",deleteConfirm:"是否要刪除此行？",newMember:"新增成員",table:{name:"成員姓名",number:"工號",department:"所屬部門",operation:"操作"}},US:{add:"add",delete:"delete",save:"save",cancel:"cancel",edit:"edit",deleteConfirm:"Confirm to delete this row?",newMember:"new member",table:{name:"Member Name",number:"Job Number",department:"Department",operation:"Operation"}}}}},"97e9":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{attrs:{bordered:!1}},[n("h2",[e._v("选择用户类型")]),n("a-space",[n("a-input-search",{staticStyle:{width:"300px","margin-left":"10px"},attrs:{placeholder:"请输入用户名","enter-button":""},on:{search:function(t){return e.onSearch()}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}})],1),n("br"),n("br"),n("a-table",{key:e.itemKey,attrs:{"data-source":e.data,columns:e.columns,pagination:e.pagination},scopedSlots:e._u([e._l(["name","password"],(function(t){return{key:t,fn:function(a,i){return[n("div",{key:t},[i.editable?n("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:a},on:{change:function(n){return e.handleChange(n.target.value,i,t)}}}):[e._v(" "+e._s(a)+" ")]],2)]}}})),{key:"operation",fn:function(t,a){return[n("div",{staticClass:"editable-row-operations"},[a.editable?n("span",[n("a-space",[n("a",{on:{click:function(){return e.save(a.key)}}},[e._v("Save")]),n("a-popconfirm",{attrs:{title:"Sure to cancel?"},on:{confirm:function(){return e.cancel(a.key)}}},[n("a",[e._v("Cancel")])])],1)],1):n("span",[n("a",{attrs:{disabled:""!==e.editingKey},on:{click:function(){return e.edit(a.key)}}},[e._v("Edit")])])]),e.data.length?n("a-popconfirm",{attrs:{title:"Sure to delete?"},on:{confirm:function(){return e.onDelete(a.key)}}},[n("a",{attrs:{href:"javascript:0;"}},[e._v("Ban")])]):e._e()]}}],null,!0)})],1)},i=[],r=n("2909"),o=n("1da1"),s=n("5530"),c=(n("96cf"),n("d81d"),n("4de4"),n("b0c0"),n("d3b7"),n("ac8f")),u=[{title:"用户名",dataIndex:"name",width:"20%",scopedSlots:{customRender:"name"}},{title:"密码",dataIndex:"password",width:"20%",scopedSlots:{customRender:"password"}},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],d=[],l={name:"UserForm",inject:["reload"],i18n:n("88eb"),data:function(){var e=this;return this.cacheData=d.map((function(e){return Object(s["a"])({},e)})),{type:"",type1:0,data:d,columns:u,form:this.$form.createForm(this),user_info:{username:"",password:""},user_visible:!0,searchText:"",editingKey:"",editData:{},changeable:!0,selectedType:"全部",pagination:{current:1,onChange:function(t){if(e.changeable)if(e.$forceUpdate(),"搜索"==e.selectedType){var n={keyword:e.searchText,page_num:current,page_size:20};Object(c["u"])(n).then((function(n){var a=n.data;d.length=0;for(var i=0;i<a.total;i++)d.push({name:a.users[i].username,password:a.users[i].password,editable:!0});e.cacheData=d.map((function(e){return Object(s["a"])({},e)})),e.totalCnt+=a.total,e.pagination.total=a.total,e.loading=!1,e.itemKey=Math.random(),e.pagination.current=t})).catch((function(e){}))}else{n={keyword:"",page_num:e.pagination.current,page_size:20};Object(c["n"])(n).then((function(n){for(var a=0;a<d.length;a++)d[a].target=!1;var i=n.data;d.length=0;for(var r=0;r<i.total;r++)d.push({name:i.users[r].username,password:i.users[r].password});e.cacheData=d.map((function(e){return Object(s["a"])({},e)})),e.loading=!1,e.pagination.total=i.total,e.pagination.current=t})).catch((function(e){}))}else alert("请完成修改后再切换页面！")},total:10},itemKey:""}},watch:{editingKey:function(e){this.changeable=""===e}},mounted:function(){this.init()},methods:{init:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadUser();case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),loadUser:function(){var e=this;this.loading=!0,d.length=0,this.pagination.current=1;var t={keyword:"",page_num:this.pagination.current,page_size:20};Object(c["n"])(t).then((function(t){for(var n=0;n<d.length;n++)d[n].target=!1;var a=t.data;d.length=0;for(var i=0;i<a.total;i++)d.push({name:a.users[i].username,password:a.users[i].password});e.cacheData=d.map((function(e){return Object(s["a"])({},e)})),e.totalCnt=a.total,e.loading=!1,e.pagination.total=a.total})).catch((function(e){}))},onDelete:function(e){var t=this,n=Object(r["a"])(this.data);this.data=n.filter((function(t){return t.key!==e}));var a=n.filter((function(t){return e===t.key}))[0],i={id:a.key,name:a.name,usertype:this.type1,institution:a.ins,mail:a.email},o=this;Object(c["b"])(i).then((function(e){t.$message.info("成功删除")})).then((function(e){o.reload()})).catch((function(e){}))},handleChange:function(e,t,n){this.editData.key||(this.editData=t),"name"===n?this.editData.name=e:"ins"===n?this.editData.ins=e:"email"===n?this.editData.email=e:"type"===n&&(alert("暂不允许修改用户类型！！"),this.reload()),this.loadUser()},edit:function(e){var t=Object(r["a"])(this.data),n=t.filter((function(t){return e===t.key}))[0];this.editingKey=e,n&&(n.editable=!0,this.data=t)},save:function(e){var t=this,n=Object(r["a"])(this.data),a=Object(r["a"])(this.cacheData),i=n.filter((function(t){return e===t.key}))[0],o=a.filter((function(t){return e===t.key}))[0];i&&o&&(delete i.editable,this.data=n,Object.assign(o,i),this.cacheData=a),this.editingKey="","个人"==i.type?this.type1=0:"学校"==i.type?this.type1=1:this.type1=2;var s={id:this.editData.key,name:this.editData.name,institution:this.editData.ins,mail:this.editData.email},u=this;Object(c["c"])(s).then((function(e){501===e.data.code?alert(e.data.message):t.$message.info("成功修改")})).then((function(e){u.reload()})).catch((function(e){t.$message.error("无法修改"),alert("修改失败")})),i&&(Object.assign(i,this.cacheData.filter((function(t){return e===t.key}))[0]),delete i.editable,c["u"],this.data=n),this.reload(),this.loadUser()},cancel:function(e){var t=this,n=new Promise((function(n,a){var i=Object(r["a"])(t.data),o=i.filter((function(t){return e===t.key}))[0];t.editingKey="",o&&(Object.assign(o,t.cacheData.filter((function(t){return e===t.key}))[0]),delete o.editable,t.data=i),n()}));n.then(t.reload())},check_user_info:function(){if(this.user_visible){if(""==this.user_info.username||""==this.user_info.password||""==this.user_info.email)return alert("请填写完整信息"),!1}else{if(this.expert_visible){if(""==this.expert_info.username||""==this.expert_info.password||""==this.expert_info.email||""==this.expert_info.name||""==this.expert_info.organization||""==this.expert_info.ID_num)return alert("请填写完整信息"),!1;var e=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],t=[1,0,"X",9,8,7,6,5,4,3,2];if(/^\d{17}\d|x$/i.test(this.expert_info.ID_num)){for(var n,a=0,i=0;i<this.expert_info.ID_num.length-1;i++)a+=parseInt(this.expert_info.ID_num.substr(i,1),10)*e[i];return n=a%11,t[n]==this.expert_info.ID_num.substr(17,1).toUpperCase()||(alert("身份证格式有误"),!1)}return alert("身份证格式有误"),!1}if(this.company_visible&&(""==this.company_info.username||""==this.company_info.password||""==this.company_info.email||""==this.company_info.name||""==this.company_info.address))return alert("请填写完整信息"),!1}return!0},adminCreateUser:function(){this.user_visible=!0},adminCreateExpert:function(){this.expert_visible=!0},adminCreateCompany:function(){this.company_visible=!0},handleSubmit:function(){var e=this;this.check_user_info()&&(this.user_visible?Object(c["g"])(this.user_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetUserInfo(),e.user_visible=!1)})).catch((function(e){})):this.expert_visible?Object(c["f"])(this.expert_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetExpertInfo(),e.expert_visible=!1)})).catch((function(e){})):this.company_visible&&Object(c["e"])(this.company_info).then((function(t){410==t.data.code?alert("用户名或邮箱已被注册"):501==t.data.code?alert(t.data.message):(e.resetCompanyInfo(),e.company_visible=!1)})).catch((function(e){})))},resetUserInfo:function(){this.user_info={username:"",password:"",email:""}},resetExpertInfo:function(){this.expert_info={username:"",password:"",email:"",name:"",organization:"",ID_num:""}},resetCompanyInfo:function(){this.company_info={username:"",password:"",email:"",name:"",address:""}},onSearch:function(){var e=this;this.pagination.current=1;var t=this.searchText,n={keyword:t,page_num:this.pagination.current,page_size:20};this.selectedType="搜索",Object(c["u"])(n).then((function(t){var n=t.data;d.length=0;for(var a=0;a<n.total;a++)d.push({name:n.users[a].username,password:n.users[a].password,editable:!0});e.totalCnt=n.total,e.loading=!1,e.pagination.total+=e.totalCnt,e.itemKey=Math.random()})).catch((function(e){}))},selectChange:function(e){var t=this;if(this.changeable){this.pagination.current=1;var n={keyword:"",page_num:this.pagination.current,page_size:20};Object(c["n"])(n).then((function(e){var n=e.data;d.length=0;for(var a=0;a<n.data.length;a++)0==n.data[a].type?t.type="普通用户":1==n.data[a].type?t.type="专家认证中":2==n.data[a].type?t.type="企业认证中":3==n.data[a].type?t.type="封禁中":4==n.data[a].type?t.type="认证专家":5==n.data[a].type&&(t.type="认证企业"),d.push({key:n.data[a].id,name:n.data[a].username,ins:n.data[a].institution,type:t.type,email:n.data[a].email,editable:!1});t.totalCnt=n.data.total_count,t.loading=!1,t.pagination.total=n.page_num,t.itemKey=Math.random()})).catch((function(e){}))}else alert("请先完成编辑！")}}},f=l,p=(n("220d"),n("2877")),h=Object(p["a"])(f,a,i,!1,null,"543d3860",null);t["default"]=h.exports},ac8f:function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"t",(function(){return o})),n.d(t,"s",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"k",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return m})),n.d(t,"h",(function(){return g})),n.d(t,"j",(function(){return _})),n.d(t,"o",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return O})),n.d(t,"u",(function(){return j})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return x}));n("1da1"),n("96cf"),n("99af");var a=n("7424"),i=n("b775");var r=function(e){var t="Interpretation",n=a["BASE_URL_IP"]+"/api/".concat(t,"/getkeywords");return Object(i["e"])(n,"get",e)},o=function(e){var t=a["BASE_URL_IP"]+"/api/recommend";return Object(i["e"])(t,"get",e)},s=function(e){var t="Interpretation",n=a["BASE_URL_IP"]+"/api/".concat(t,"/getvis");return Object(i["e"])(n,"get",e)},c=function(e){var t="Interpretation",n=a["BASE_URL_IP"]+"/api/".concat(t,"/gettags");return Object(i["e"])(n,"get",e)},u=function(e,t){var n=a["BASE_URL_IP"]+"/api/comment";return Object(i["e"])(n,e,t)},d=function(e){var t=a["BASE_URL_IP"]+"/api/user/profile";return e?Object(i["e"])(t,"get",{user_id:e}):Object(i["e"])(t,"get")},l=function(e,t,n,r){var o=1===t?"Interpretation":"Note",s=a["BASE_URL_IP"]+"/api/".concat(o,"/").concat(e);return Object(i["e"])(s,n,r)},f=function(e){if(null===e||void 0===e)return"无";var t=new Date(e),n=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),a=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),i=t.getHours()<10?"0"+t.getHours():t.getHours();return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate()," ").concat(i,":").concat(a,":").concat(n)},p=function(e){return e?Object(i["e"])(a["PaperAll"],"get",{user_id:e}):Object(i["e"])(a["PaperAll"],"get")},h=function(e,t){var n=a["BASE_URL_IP"]+"/api/comment/create";return Object(i["e"])(n,e,t)},m=function(e,t){var n=a["BASE_URL_IP"]+"/api/comment/delete";return Object(i["e"])(n,e,t)},g=function(e){var t=a["BASE_URL_IP"]+"/api/discussion/create";return Object(i["e"])(t,"post",e)},_=function(e,t){var n=a["BASE_URL_IP"]+"/api/discussion/delete";return Object(i["e"])(n,e,t)},b=function(e){return e?Object(i["e"])(a["UserAll"],"get",{user_id:e}):Object(i["e"])(a["UserAll"],"get")},v=function(e){var t=a["BASE_URL_IP"]+"/api/manage/users";return Object(i["e"])(t,"get",e)},y=function(e){var t=a["BASE_URL_IP"]+"/api/user/delete";return Object(i["e"])(t,"post",e)},O=function(e){var t=a["BASE_URL_IP"]+"/api/user/changeinfo";return Object(i["e"])(t,"post",e)},j=function(e){var t=a["BASE_URL_IP"]+"/api/manage/users";return Object(i["e"])(t,"get",e)},w=function(e){var t=a["BASE_URL_IP"]+"/api/admin/add/user";return Object(i["e"])(t,i["a"].POST,e)},I=function(e){var t=a["BASE_URL_IP"]+"/api/admin/add/expert";return Object(i["e"])(t,i["a"].POST,e)},x=function(e){var t=a["BASE_URL_IP"]+"/api/admin/add/enterprise";return Object(i["e"])(t,i["a"].POST,e)}},eae1:function(e,t,n){}}]);